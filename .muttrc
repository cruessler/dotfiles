set folder=~/mail
set header_cache=~/.cache/mutt
set message_cachedir=~/.cache/mutt

set sendmail="/usr/bin/msmtp"
set envelope_from=yes
set edit_hdrs
set include=yes

# https://superuser.com/a/407797
set menu_scroll
set pager_index_lines=10

# https://www.neomutt.org/feature/sidebar#muttrc
set sidebar_visible=yes
set sidebar_short_path=yes
set sidebar_delim_chars='/.'
set sidebar_divider_char='┃'
set sidebar_folder_indent=yes
set sidebar_indent_string='  '
set sidebar_format="%B%?F? [%F]?%* %?N?%N/?%S"
set sidebar_next_new_wrap=yes
set sidebar_new_mail_only
set mail_check_stats

bind index,pager B sidebar-toggle-visible
bind index,pager \Ck sidebar-prev
bind index,pager \Cj sidebar-next
bind index,pager \Co sidebar-open

# starting with mutt 1.9.4 (after upgrade from 1.8.3), mutt recognizes \Cj as
# <Return>, thus overwriting the default binding for <Return> (which is
# display-message)
#
# the same bug has been reported for an earlier version,
# see https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=547661
bind index <Return> display-message

bind index,pager p search-opposite

# this fix is suggested by mutt on startup
# binding 'gg' would alias 'g' (which shouldn’t be a problem, apart from the
# waring, since 'g' is not bound currently)
bind index g noop

bind index gg first-entry
bind index G last-entry

# https://github.com/scheibler/khard/issues/16#issuecomment-112171204
macro index,pager A \
  "<pipe-message>khard add-email<return>" \
  "add the sender email address to khard"

auto_view text/html
alternative_order text/plain text/html

set my_tmp_html_path="/tmp/mutt-mail.html"
macro attach V "<pipe-entry>cat > $my_tmp_html_path && xdg-open $my_tmp_html_path<enter>"

set query_command="khard email --parsable %s"
bind editor <Tab> complete-query
bind editor ^T complete

source ~/.mutt/accounts

source ~/.mutt/colors-solarized-dark-256.muttrc
